---
import { Image } from "astro:assets";
import ProyectoHome from "../Assets/Images/ProyectoHome.png";
import github from "../assets/Images/github.png";
import ButtonSecundary from "./ButtonSecundary.astro";
---

<div class="flip-card-container">
  <div class="flip-card-inner">

    {/* Cara frontal de la tarjeta */}
    <div class="flip-card-front card-wrapper lg:w-[250px] lg:h-[170px] xl:w-[150px] xl:h-[100px] flex items-center justify-center object-cover flex-col button-flip cursor-pointer transition-all duration-200 ease-in-out
    hover:scale-104 hover:shadow-[0_4px_15px_rgba(255,255,255,0.08)]">
    <div class="card-image">
        <slot name="image"/> 
    </div>
      <div>
        <slot name= "titulo"/>
    </div>  
    </div>

    <div class="flip-card-back card-wrapper lg:w-[250px] lg:h-[170px] xl:w-[150px] xl:h-[100px] flex flex-col items-center justify-center object-cover button-flip">
    <slot name="titulotrasero"/>
    <slot name="parrafo"/>
    
    <div class="flex justify-between gap-2">
        
        {/* 1. Botón de Enlace/Proyecto (linkContent) */}
        <ButtonSecundary class="w-16">
            <slot name="linkContent"/> {/* Recibe el <a>...</a> completo */}
        </ButtonSecundary> 

        {/* 2. Botón de GitHub (githubIcon) */}
        <ButtonSecundary class="w-16">
            {/* Recibe el <a><img...></a> completo para el botón de GitHub */}
            <slot name="githubLink"/> 
        </ButtonSecundary>
        
    </div>
</div>

  </div>
</div>

<script>
    // 1. Selecciona TODOS los contenedores exteriores de las tarjetas
    const cardContainers = document.querySelectorAll(".flip-card-container");

    // NOTA: No necesitamos 'cardWrappers' (el div de las caras) si trabajamos con el contenedor principal.
    // NOTA: 'cardContainer' ya no se usa aquí porque ahora tenemos la lista 'cardContainers'.

    // 2. Itera sobre CADA contenedor de tarjeta
    cardContainers.forEach(container => {
        // 3. Busca TODOS los botones de giro DENTRO del contenedor actual (frente y dorso)
        const flipButtons = container.querySelectorAll(".button-flip");

        // 4. Itera sobre los botones de giro de ESA tarjeta específica
        flipButtons.forEach(button => {
            // 5. Aplica el evento de clic
            button.addEventListener("click", () => {
                // Alterna la clase 'flipped' en el CONTENEDOR ACTUAL de la iteración.
                container.classList.toggle("flipped");
            });
        });
    });
</script>

<style>

  .card-image{
    width: 100%;
    object-fit: cover;
    display: flex;
    justify-content: center;

  }  

  /* Contenedor principal para mantener la perspectiva 3D */
  .flip-card-container {
    width: 250px; /* Ancho de tu tarjeta */
    height: 170px; /* Alto de tu tarjeta */
    perspective: 1000px; /* Perspectiva para el efecto 3D */
    margin: 10px; /* Espaciado entre tarjetas */
  }

  /* Contenedor interno que realmente gira */
  .flip-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    text-align: center;
    transition: transform 0.8s; /* Velocidad de la animación de giro */
    transform-style: preserve-3d; /* ¡IMPORTANTE! Permite que los hijos se posicionen en 3D */
  }

  /* Cuando el contenedor principal tiene la clase 'flipped', gira el contenido interno */
  .flip-card-container.flipped .flip-card-inner {
    transform: rotateY(180deg);
  }

  /* Estilos para las caras frontal y trasera */
  .flip-card-front, .flip-card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    -webkit-backface-visibility: hidden; /* Oculta la cara trasera cuando está al revés */
    backface-visibility: hidden; /* Estándar */
    border-radius: 2px;
    display: flex; /* Asegura que el contenido se centre bien */
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 10px;
    background-color: transparent; /* Color de fondo por defecto */
    color: #ffffff;
  }

  /* Estilo específico para la cara trasera */
  .flip-card-back {
    background-color: #ffffff; /* Otro color para distinguir */
    color: black;
    transform: rotateY(180deg); /* La cara trasera empieza rotada 180 grados */
  }

  /* Ajustes para las imágenes dentro de las tarjetas */
  .flip-card-front .object-cover {
    height: 60%; /* Ajusta la altura de la imagen en la cara frontal */
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden; /* Para que la imagen se adapte bien */
  }
  .flip-card-front img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain; /* o cover, dependiendo de tu preferencia */
  }

  /* Opcional: ajustar tamaños para lg y xl como tenías */
  .flip-card-container.lg\:w-\[250px\] { width: 250px; }
  .flip-card-container.lg\:h-\[170px\] { height: 170px; }
  .flip-card-container.xl\:w-\[150px\] { width: 150px; }
  .flip-card-container.xl\:h-\[100px\] { height: 100px; }
</style>